{"version":3,"sources":["../../src/features/users/use-cases/sendActivationLink.ts"],"names":[],"mappings":";;;AAAA,sEAAmE;AAGnE,SAAgB,6BAA6B,CAAC,EAAE,UAAU,EAAmC;IAC5F,OAAO,KAAK,EAAE,KAAa,EAAE,EAAE;QAC9B,IAAI,CAAC,KAAK,EAAE;YACX,MAAM,IAAI,2BAAY,CAAC;gBACtB,OAAO,EAAE,mBAAmB;gBAC5B,MAAM,EAAE,SAAS;gBACjB,UAAU,EAAE,GAAG;gBACf,IAAI,EAAE;oBACL,KAAK;iBACL;aACD,CAAC,CAAC;SACH;QACD,MAAM,QAAQ,GAAG,MAAM,UAAU,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QACrD,IAAI,CAAC,QAAQ,EAAE;YACd,MAAM,IAAI,2BAAY,CAAC;gBACtB,OAAO,EAAE,gBAAgB;gBACzB,MAAM,EAAE,SAAS;gBACjB,UAAU,EAAE,GAAG;gBACf,IAAI,EAAE;oBACL,KAAK;iBACL;aACD,CAAC,CAAC;SACH;QACD,IAAI,QAAQ,CAAC,QAAQ,EAAE;YACtB,MAAM,IAAI,2BAAY,CAAC;gBACtB,OAAO,EAAE,gCAAgC;gBACzC,MAAM,EAAE,SAAS;gBACjB,UAAU,EAAE,GAAG;gBACf,IAAI,EAAE,EACL;aACD,CAAC,CAAC;SACH;QAED,OAAO,QAAQ,CAAC;IACjB,CAAC,CAAC;AAEH,CAAC;AApCD,sEAoCC","file":"sendActivationLink.js","sourcesContent":["import { ExpressError } from '../../../common/errors/ExpressError';\nimport { IUserRepository } from '../interfaces';\n\nexport function makeSendAccountActivationLink({ repository }: { repository: IUserRepository }) {\n\treturn async (email: string) => {\n\t\tif (!email) {\n\t\t\tthrow new ExpressError({\n\t\t\t\tmessage: 'Email is required',\n\t\t\t\tstatus: 'warning',\n\t\t\t\tstatusCode: 400,\n\t\t\t\tdata: {\n\t\t\t\t\temail\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tconst existing = await repository.findByEmail(email);\n\t\tif (!existing) {\n\t\t\tthrow new ExpressError({\n\t\t\t\tmessage: 'User not found',\n\t\t\t\tstatus: 'warning',\n\t\t\t\tstatusCode: 404,\n\t\t\t\tdata: {\n\t\t\t\t\temail\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (existing.isActive) {\n\t\t\tthrow new ExpressError({\n\t\t\t\tmessage: 'User account already activated',\n\t\t\t\tstatus: 'warning',\n\t\t\t\tstatusCode: 409,\n\t\t\t\tdata: {\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn existing;\n\t};\n\n}"]}